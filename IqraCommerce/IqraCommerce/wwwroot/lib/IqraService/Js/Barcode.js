var Ean13=new function(){function a(t){var r=o;t.fillRect(r,f,n,i);r+=n*2;t.fillRect(r,f,n,i);r=u[5].Point.X+n*8;t.fillRect(r,f,n,i);r+=n*2;t.fillRect(r,f,n,i);r=u[11].Point.X+n*7;t.fillRect(r,f,n,i);r+=n*2;t.fillRect(r,f,n,i);u.each(function(){this.Draw(t)})}function v(){var l=e[0],a=c[l],i=parseInt(l+""),t,f;for(u=[],o+=3*n,t=1;t<7;t++)i+=s(e[t],t),f=h(e[t],t-1,r.WhitePen,r.BlackPen),f.SetDirection(a[t-1]),u.push(f);for(o+=5*n,t=7;t<12;t++)i+=s(e[t],t),f=h(e[t],t-1,r.BlackPen,r.WhitePen),u.push(f);console.log(["checkSum",i]);i=i%10;u.push(h(i==0?"0":10-i+"",11,r.BlackPen,r.WhitePen));o-=8*n}function y(){return{"0":[!1,!1,!1,!1,!1,!1],"1":[!1,!1,!0,!1,!0,!0],"2":[!1,!1,!0,!0,!1,!0],"3":[!1,!1,!0,!0,!0,!1],"4":[!1,!0,!1,!1,!0,!0],"5":[!1,!0,!0,!1,!1,!0],"6":[!1,!0,!0,!0,!1,!1],"7":[!1,!0,!1,!0,!1,!0],"8":[!1,!0,!1,!0,!0,!1],"9":[!1,!0,!0,!1,!0,!1]}}function s(n,t){var i=parseInt(n+"");return t%2==0?i:i*3}function t(n,t){return[{Width:n[0],StartAt:n[1]},{Width:t[0],StartAt:t[1]}]}function h(u,e,s,h){var l={X:o+e*7*n,Y:f},c=new r(l,i,n,s,h,u);switch(u){case"0":return c.AddLines(t([n*2,n*3],[n,n*6])),c;case"1":return c.AddLines(t([n*2,n*2],[n,n*6])),c;case"2":return c.AddLines(t([n,n*2],[n*2,n*5])),c;case"3":return c.AddLines(t([n*4,n*1],[n,n*6])),c;case"4":return c.AddLines(t([n,n],[n*2,n*5])),c;case"5":return c.AddLines(t([n*2,n],[n,n*6])),c;case"6":return c.AddLines(t([n,n],[n*4,n*3])),c;case"7":return c.AddLines(t([n*3,n],[n*2,n*5])),c;case"8":return c.AddLines(t([n*2,n],[n*3,n*4])),c;case"9":return c.AddLines(t([n,n*3],[n*2,n*5])),c}return new Font0(l,i,n)}function r(n,t,i,r,u,f){function v(n){var i,t;n.fillStyle=c;n.fillRect(e.X,e.Y,h*7,s);for(i in o)t=o[i],n.fillStyle=l,n.fillRect(e.X+t.StartAt,e.Y,t.Width,s),t.Rect=[e.X+t.StartAt,e.Y,t.Width,s]}function y(n){var t,i;for(n.fillStyle=l,n.fillRect(e.X,e.Y,h*7,s),i=o.length-1;i>-1;i--)t=o[i],n.fillStyle=c,n.fillRect(e.X+7*h-t.StartAt-t.Width,e.Y,t.Width,s),t.Rect1=[e.X+t.StartAt,e.Y,t.Width,s]}var o=[],s=t,h=i,e=n,c=r,l=u,a;this.BackColor=r;this.FillColor=u;this.Lines=o;this.Later=f;this.Point=n;this.FontBase=function(n,t,i,r,u){this.Point=n;this.Height=t;this.BarWidth=i;this.BackColor=r;this.FillColor=u};this.Draw=function(n){a?y(n):v(n)};this.SetDirection=function(n){a=n;this.IsDesc=n};this.AddLine=function(n){o.push(n)};this.AddLines=function(n){return this.Lines=o=o.concat(n),this}}function p(){for(var i=Math.floor(Math.random()*8999)+1e3+""+(Math.floor(Math.random()*8999)+1e3)+""+(Math.floor(Math.random()*8999)+1e3)+"",r=i[0],n=parseInt(r+""),t=1;t<12;t++)n+=s(i[t],t);return n=n%10,i+(n==0?"0":10-n)}function w(n){return n=n||{},setNonCapitalisation(n),n.height=n.height||40,n.width=n.width||140,n.text=n.text||n.code,n.code=n.code||n.text,n}var c=y(),l=1,n=1,i=1,u=[],e="",o=0,f=0;r.WhitePen="#FFFFFF";r.BlackPen="#000000";this.Check=function(n){var i;if(n.length!=13)return!1;var r=n[0],t=parseInt(r+"");for(i=1;i<12;i++)t+=s(n[i],i);return t=t%10,n[12]===(t==0?"0":10-t+"")};this.Get=function(t){var h,c,r,s;if(t=w(t),h=t.width,c=t.height,!t.code)return p();e=t.text;n=(h-4)/95;o=(h-n*95)/2;f=2;l=n*7;i=c-4;r=document.createElement("canvas");s=r.getContext("2d");r.width=h;r.height=c;s.font="10px Arial";s.fillStyle="#FFFFFF";s.fillRect(0,0,r.width,r.height);s.fillStyle="#000000";v();a(s);console.log(["fonts",u]);$(document.body).append('<img style="position:fixed; top:100px;left:500px;" src="'+r.toDataURL("image/png")+'"/>')};this.Bind=function(n){var t=that.Get(n);n.elm.html('<img src="'+t+'"/>')};this.Print=function(n,t){typeof n=="string"&&(n={Code:n,text:t});Global.Print('<img src="'+that.Get(n)+'"/>')}},code=Ean13.Get();Ean13.Get({code:"6298996158568",width:400,height:70});console.log([code,Ean13.Check("6298996158568")])