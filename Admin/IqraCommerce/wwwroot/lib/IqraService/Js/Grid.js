(function(n,t,i,r){function p(n){n.busyLayer||(n.busyLayer=$('<div style="position: absolute; width: 100%; height: 100%; top: 0px; z-index: 5;"><div style="width: 100%; height: 100%; position: absolute; z-index: 1; opacity: 0.4; background-color: rgb(255, 255, 255);"><\/div><div style="width: 100%; height: 100%; position: absolute; z-index: 2; background-image: url(\''+Global.BaseUrl+IqraConfig.Url.Img.Grid.Loading+"'); background-repeat: no-repeat; background-position: center center;\"><\/div><\/div>"),n.views.container.prepend(n.busyLayer));n.busyLayer.show()}function h(n){n.busyLayer&&n.busyLayer.hide()}function c(n){return o.measureText(n).width}function g(n){var t=' style="';return n.width&&(t+="width: "+(typeof n.width=="string"?n.width=="fit"?n.measuredwidth+"px":n.width:n.width+"px")+";"),n.maxwidth&&(t+="max-width: "+(typeof n.maxwidth=="string"?n.maxwidth=="fit"?n.measuredmaxwidth+"px":n.maxwidth:n.maxwidth+"px")+";"),n.minwidth&&(t+="min-width: "+(typeof n.minwidth=="string"?n.minwidth=="fit"?n.measuredminwidth+"px":n.minwidth:n.minwidth+"px")+";"),t+'"'}function nt(n){var i=n.elm.width(),u=n.action?1:0,t=[],r={widthList:[],ActiveColumns:t,HideColumns:[],containerWidth:i};return n.columns.each(function(){t.push(this)}),n.RSModel=r,""}function tt(n,t,i){for(var r=0;r<t.length;r++)if(setNonCapitalisation(t[r]),t[r].max&&t[r].max>=i||t[r].min&&t[r].min<=i)return t[r].width}function l(n,t,i,r){var u=n[i];return n[i]?(typeof n[i]=="string"&&(u=n[i]=u.trim().toLowerCase(),u=u=="fit"?n["measured"+i]=c(n.title||n.field)+10+(n.filter?20:0)+(n.sorting!==!1?15:0):u[u.length-1]=="%"?parseFloat(u.replace("%",""))*r/100:parseFloat(u.replace(/px/ig,""))),u):t}function it(n,t,i){var r=l(n,0,"width",i),u=l(n,r,"maxwidth",i),f=l(n,0,"minwidth",i);return r>u&&(r=u),r<f&&(r=f),r}function rt(n,t){var i=t.width()-17,r=0,a=0,f=0,v=n.action?1:0,s=[],o=[],h=[],l={widthList:s,ActiveColumns:o,HideColumns:h,containerWidth:i},u=0,e=0;return(n.action&&(u=1,r=40),n.columns.each(function(n){var t=0;this.width&&this.width.New&&this.width.each&&(this.width=tt(this,this.width,i));this.width?(e+=it(this,this.width,i),t=f=e+r*u):(u++,r=Math.max(c(this.title||this.field)+10+(this.filter?20:0)+(this.sorting!==!1?15:0),r),t=f=e+r*u);s.push({width:f,column:this,tableWidth:t,maxWidth:r,columnWidth:a,width:f,textWidth:c(this.title||this.field),widthCol:u,fixedWidth:e,Con:t<=i,containerWidth:i});n==0||t<=i?o.push(this):h.push(this)}),n.RSModel=l,o.length!=n.columns.length)?(l.IsHide=!0,'<col style="width: 20px;">'):""}function a(n,t){if(n.ColGroupTemplate)return n.ColGroupTemplate;if(n.ColGroupTemplate="<colgroup>",n.ColGroupTemplate+=n.responsive||IqraConfig.Grid.Responsive&&n.responsive!==!1?rt(n,t):nt(n),n.RSModel.ActiveColumns.each(function(){var t=g(this),i=this.className?' class="'+this.className+'"':"";n.ColGroupTemplate+="<col"+t+i+">"}),n.action){var i=n.action.width?' style="width: '+n.action.width+'px;"':"",r=n.action.className?' class="'+n.action.className+'"':"";n.ColGroupTemplate+="<col"+i+r+">"}return n.ColGroupTemplate+="<\/colgroup>",n.ColGroupTemplate}function w(n,t){switch(n.type){case 1:if(typeof t=="number"&&t.toFloat)return n.style=n.style||"text-align: right; white-space: pre;",t.toFloat();case 2:if(typeof t=="number"&&t.toMoney)return n.style=n.style||"text-align: right; white-space: pre;",t.toMoney()}return t}function e(n){n.header=n.header||{};n.header.BodyHeight=n.Body.view.height()}var d,o,u;LazyLoading.LoadCss([IqraConfig.Url.Css.Grid]);d=this;u={},function(){var n=document.createElement("canvas");o=n.getContext("2d");o.font=$(document).width()>768?"14px Arial":"10px Arial"}();var ut=new function(){function t(t,i){var r,f,u;t.response&&(r="",f=[],n||(n=$('<form action="/Health/Report/ExportToCSV" method="post"><\/form>'),$(document.body).append(n)),n.html('<input type="hidden" class="column_header" name="columnHeader"/>'),n.attr("action",i),u=t.exportColumns||t.columns,u.each(function(){r+=this.title+","}),t.response.Data.Data.each(function(t){var r=this,i="";u.each(function(){var n=r[this.field];i+=(typeof n!="undefined"&&n!=null?n:"")+","});n.append('<input type="hidden" name="columns['+t+']" value="'+i+'"/>')}),n.find(".column_header").val(r),n.submit())}function i(){var n=$(this).parent().data("model");t(n,"/Report/ExportToCSV",",")}var n;this.Bind=function(n){n.reportContainer&&(n.reportContainer.data("model",n),n.reportContainer.append($('<a class="btn btn-white btn-default btn_export btn-round pull-right"><span class="glyphicon glyphicon-export"><\/span>Export To CSv<\/a>').click(i)))}},b=new function(){function i(n,t){var t=w(n,t);return'<td style="border: 1px solid silver; padding: 5px;'+(n.style||"")+'">'+t+"<\/td>"}function s(n){return'<th style="border: 1px solid silver; padding: 5px;">'+n+"<\/th>"}function h(t,i,r,u){if(u=u+"",r=="header"){var e=$("<div>").append(u),f="";t.Printable.reporttitle&&(typeof t.Printable.reporttitle=="string"?f=t.Printable.reporttitle:typeof t.Printable.reporttitle==typeof n?f=t.Printable.reporttitle(t):typeof t.Printable.reporttitle.html==typeof n&&(f=t.Printable.reporttitle.html(t)),e.find(".report_title").append(f));u=e.html()}return u}function c(t){if(t.Printable.columns)if(typeof t.Printable.columns==typeof n)v=t.Printable.columns(t);else return t.Printable.columns;else return t.columns}function l(n,t,r){n.response=n.response||{};n.response.Data=n.response.Data||{};var u=n.response.Data.Data||[];u.each(function(){var n="<tr>",u=this;r.each(function(){var t=u[this.field];this.dateFormat&&/^\/Date\(\-?\d+\)\/$/.test(t)&&(t=t.getDate().format(this.dateFormat));t=typeof t!="undefined"&&t!=null?t:"";n+=this.onprint?this.onprint.call(u,this,t,i(this,t)):i(this,t)});n+="<\/tr>";t.document.write(n)})}function a(n,t,i){var r="<thead><tr>";i.each(function(){r+=s(this.title||this.field)});r+="<\/tr><\/thead><tbody>";t.document.write(r)}function u(t,i,r){if(t.Printable[r]){var u="";typeof t.Printable[r]=="string"?u=t.Printable[r]:typeof t.Printable[r]==typeof n?u=t.Printable[r](t):typeof t.Printable[r].html==typeof n&&(u=t.Printable[r].html(t));u=h(t,i,r,u);i.document.write("<"+r+">"+u+"<\/"+r+">")}}function y(n){var i="",t={};return n.each(function(){Global.Copy(t={},this,!0);setNonCapitalisation(t);i+='<div class="col" style="width:25%;"><div class="label"> '+(t.title||t.field)+" <\/div><div>"+(o[t.operation]||"")+(t.printValue||t.value)+"<\/div><\/div>"}),i}function p(n,t,i){var r=t.width||n.itemwidth||"";return console.log(["",r,r=="fit"&&i.length>0,r=="fit",i.length>0,i.length]),r&&(r=r+"",r=="fit"&&i.length>0?r="calc("+100/i.length+"% - 22px)":/%|(px)/.test(r)||(r=r+"px"),r='style="width:'+r+';"'),r}function t(n,t){var u="",f,i="";return t.each(function(){setNonCapitalisation(this);typeof n.SummaryData[this.field]!=typeof r&&(f=this.type===2?(n.SummaryData[this.field]||0).toMoney():this.type===1?(n.SummaryData[this.field]||0).toFloat():n.SummaryData[this.field]||0,i='<div class="col"'+p(n.Printable,this,t)+'><div class="label"> '+(this.title||this.field)+" <\/div><div>"+f+"<\/div><\/div>",u+=this.created&&(i=this.created(i))||i)}),u}function b(i,r){var u,f,e;if(i.Printable.summary=i.Printable.summary||i.summary,i.Printable.summary){if(u="",i.Printable.summary===!0){f=[];for(e in i.SummaryData)e!="Total"&&f.push({field:e,type:2});u=t(i,f)}else typeof i.Printable.summary=="string"?u=i.Printable.summary:typeof i.Printable.summary==typeof n?u=i.Printable.summary(i):typeof i.Printable.summary.html==typeof n?u=i.Printable.summary.html(i):typeof i.Printable.summary==typeof[]&&i.Printable.summary.New?u=t(i,i.Printable.summary):typeof i.Printable.summary==typeof i.Printable&&(setNonCapitalisation(i.Printable.summary),i.Printable.summary.items&&(u=t(i,i.Printable.summary.items)));r.document.write('<div class="row summary_container">'+u+"<\/div>")}}function k(n,t){var r,u,i,f,o,s;n.Printable.periodic=n.Printable.periodic||n.periodic;r="";u=[];n.Printable.periodic&&(i=n.Printable.periodic,f=e[i.model.field]||i.model.field,r+='<div class="col" style="width:25%;"><div class="label"> Filter By <\/div><div>'+f+"<\/div><\/div>",o=n.page.filter.where('itm=>itm.Operation == 2 && itm.field == "'+i.model.field+'"').orderBy("value",!0)[0],s=n.page.filter.where('itm=>itm.Operation == 3&& itm.field == "'+i.model.field+'"').orderBy("value")[0],r+='<div class="col" style="width:25%;"><div class="label"> From <\/div><div>'+o.value.substring(1,i.model.format.length+1)+"<\/div><\/div>",r+='<div class="col" style="width:25%;"><div class="label"> To <\/div><div>'+s.value.substring(1,i.model.format.length+1)+"<\/div><\/div>");n.page&&n.page.filter&&n.page.filter.length&&(u=n.Printable.periodic?n.page.filter.where('itm=>itm.field != "'+i.model.field+'" && itm.printable !== false'):n.page.filter.where("itm=>itm.printable !== false"),r+=y(u));t.document.write('<div class="row filter_container">'+r+"<\/div>");t.document.write('<div class="report_title active"><\/div>')}function d(n){var t,i;return n.name=n.name||document.title,t=window.open("","PRINT","height=800,width=1200"),t.document.write("<!DOCTYPE html><html><head><title>"+n.name+"<\/title>"),t.document.write('<\/head><style type="text/css">@page{size:auto;margin: 10mm;} html{background-color: #FFFFFF;margin: 0px;} .report_title.active{border-top:2px dashed #666666;margin: 5px 0;} .row:after{clear:both;content:"";display:table;} .col{border:1px solid silver;float:left;margin:5px;padding:0 5px;width:16%;text-align:center;} .col:first-child{margin-left:0;} .label {font-weight:bold;}<\/style><body style="padding: 20px;">'),u(n,t,"header"),k(n,t),b(n,t),t.document.write('<table style="border-collapse: collapse;">'),i=c(n),a(n,t,i),l(n,t,i),t.document.write("<\/tbody><\/table>"),u(n,t,"footer"),t.document.write("<\/body><\/html>"),t.document.close(),t.focus(),t.print(),!0}function g(t){var i,u,r;if(t.Printable){if(i=t.Printable.container,u=t.Printable.html,i)typeof i=="string"?i=$(i):typeof i==typeof n&&(i=i(t));else{r=$('<div class="empty_style button_container row">'+u+"<\/div>");t.elm.prepend(r);r.find(".btn_add_print").click(t.Print);return}r=$(u);i.append(r);r.click(t.Print)}}function f(n){n.Printable=typeof n.printable==typeof r?IqraConfig.Grid.Printable:n.printable;n.Printable&&(n.Printable&&setNonCapitalisation(n.Printable),n.Printable.html=n.Printable.html||IqraConfig.Grid.Printable.html||'<a href="#" class="btn btn-white btn-default btn-round pull-right btn_add_print"><span class="glyphicon glyphicon-print"><\/span> Print <\/a>',n.Printable.container=n.Printable.container||IqraConfig.Grid.Printable.Container,n.Printable.header=n.Printable.header||IqraConfig.Grid.Printable.header,n.Printable.reporttitle=n.Printable.reporttitle||IqraConfig.Grid.Printable.reportTitle,n.Printable.footer=n.Printable.footer||IqraConfig.Grid.Printable.footer,n.Printable.summary=n.Printable.summary||IqraConfig.Grid.Printable.summary)}var e={CreatedAt:"Created At",ExpenseAt:"Expense At"},o=["= ","> ",">= ","< ","<= ","Contains - ","Starts With - ","Ends With - ","Sound Equals - ","Sound Contains - ","SoundStartsWith ","SoundEndsWith ","In - ","NotIn - "];this.SetDefaultOptions=f;this.Bind=function(n){n.Print=function(){d(n)};f(n);g(n)}},ft=new function(){function n(n){var i={title:n.title||n.field||"",className:n.className||""},t;for(t in n)i[t]=n[t];return i}this.Get=function(t){var i=[];return t.columns.each(function(){i.push(n(this))}),i}},k=new function(){function n(){var n=$(this).data("model");if(n.page.PageNumber=1,n.page.PageSize=parseInt($(this).val()),n.pagger&&n.pagger.onChange){n.pagger.onChange(n.page);return}f.Reload(n)}var t=this;this.Create=function(t,i,r,u,f){r=r||i[parseInt(i.length/2)];t.page=t.page||{PageNumber:1,PageSize:r,SortBy:""};t.page.baseUrl=t.page.baseUrl||t.action&&t.action.title&&t.action.title.baseUrl||t.pagger&&t.pagger.baseUrl||"/";t.page.showingInfo=f||"Showing {0} to {1}  of {2}  items";var e=$('<select class="form-control input-sm" style="height: auto; display: inline;">').change(n).data("model",t);i.each(function(){this==t.page.PageSize?e.append('<option selected="selected">'+this+"<\/option>"):e.append("<option>"+this+"<\/option>")});u.append(e);t.PageSize={view:e}}},v=new function(){function s(){if(!Global.Key.ctrlKey){var i=$(this),r=i.data("model"),t=i.parent().data("model"),u=r.actionfield||r.sortField||r.field;return Global.Key.altKey&&r.sorting&&r.sorting.alt&&(u=r.sorting.alt),(!t.onValidate||t.onValidate())&&(t.page=t.page||{},t.page.SortBy!=u?(n&&n.removeClass("desending asending"),i.addClass("asending"),t.page.IsDescending=!1,t.page.SortBy=u,n=i):t.page.SortBy!=u||t.page.IsDescending?(n=i,i.removeClass("desending asending"),t.page.SortBy="",t.page.IsDescending=!1):(i.removeClass("asending").addClass("desending"),t.page.IsDescending=!0,n=i),t.page.PageNumber=1,t.changing&&t.changing(e,t.page),f.Reload(t)),!1}}function h(n){var i=n.action.className?" "+n.action.className:"",t=$('<th class="i-header '+i+'" colspan="1" rowspan="1" ><\/th>');return typeof n.action.title=="object"&&n.pagging?k.Create(n,n.action.title.items,n.action.title.selected,t,n.action.title.showingInfo||n.pagger.showingInfo):t.append(n.action.title),t}function t(n){var i=n.offsetTop||0;return n.offsetParent&&(i+=t(n.offsetParent)),i}function c(n,i,r){return(n.fixedheader||IqraConfig.Grid.FixedHeader&&n.fixedheader!==!1)&&$(document).scroll(function(){if(n.header.OffsetTop=t(i),n.header.OffsetTop>0){if(n.header.BodyHeight=n.header.BodyHeight||n.Body.view.height(),n.header.OffsetTop+n.header.BodyHeight<window.scrollY){n.header.Fixed&&(n.header.Fixed=!1,i.style.height="auto",r.removeClass("fixed").css({width:"auto"}));return}n.header.OffsetTop<window.scrollY?n.header.Fixed||(n.header.Fixed=!0,i.style.height=i.offsetHeight+"px",r.addClass("fixed").css({width:i.scrollWidth-18+"px"})):n.header.Fixed&&(n.header.Fixed=!1,i.style.height="auto",r.removeClass("fixed").css({width:"auto"}))}}),i}var i=this,n,e={Type:4},o=new function(){function h(n,t){return typeof n.operation!=typeof r?t.Operation=n.operation:typeof IqraConfig.Grid.Operation!=typeof r&&(t.Operation=IqraConfig.Grid.Operation),t}function c(n,t){t=t.trim();switch(n.Operation){case"GreaterThan":case"GreaterThanOrEqual":case"LessThan":case"LessThanOrEqual":t=parseInt(t)}return h(n,{field:n.actionfield||n.field,title:n.title,value:t,type:n.filter&&n.filter.type})}function t(n,t,i){var r,u,f;n.page=n.page||{};n.page.filter=n.page.filter||[];r=[];u=t.actionfield||t.field;n.page.filter.each(function(){this.field!=u&&r.push(this)});f=c(t,i);(i||i=="0")&&r.push(f);Global.Copy(n.page.filter,r,!0);n.page.filter.length=r.length}function i(n,i,r){if(typeof i.filter=="function"){var u=i.filter(r);u&&u.each(function(){t(n,this,this.value)})}else t(n,i,r)}function n(n,r,u,e){if(!n.onValidate||n.onValidate()){var o=(e||this).val();u&&(u(n,r,o,t),1)||i(n,r,o);n.page.PageNumber=1;n.changing&&n.changing({Type:5},n.page);f.Reload(n)}return!1}function l(t,i,r){if(t.key=="Enter"||t.keyCode==13||t.which==13)return t.preventDefault(),n.call(this,i,r),!1}function a(n,t){return i(n,t,this.val()),!1}function e(n,t,i,r){var u=$('<div class="display_type" style="position: absolute; display: block; height: 15px; top: -15px; width: 15px; right: 6px; background-color: #FFFFFF; border-radius: 7px 7px 0px 0px; border: 1px solid silver; border-bottom: 0; cursor: pointer;"><span class="glyphicon glyphicon-refresh"><\/span><\/div>');r.append(u);Global.Click(u,function(){var u=n.data("altview");r=n.data("view");i.Drp&&i.Drp.Clear();r.hide();n.data("altview",r);$(document).click();u?(n.data("view",u),u.show().find("input").empty().focus()):i.filter.displaytype?s(n,t,i):o(n,t,i)})}function o(t,i,r){r.operation=r.operation||IqraConfig.Grid.Operation||0;r.filter.dropdown&&(setNonCapitalisation(r.filter.dropdown),r.filter.datasource=r.filter.dropdown.datasource,r.filter.valuefield=r.filter.valuefield||r.filter.dropdown.valuefield||"value",r.filter.textfield=r.filter.textfield||r.filter.dropdown.textfield||"text");var u=Global.Copy(Global.Copy({},r,!0),r.filter,!0),f=$('<div class="search_container datepicker-dropdown dropdown-menu datepicker-orient-right datepicker-orient-bottom"><div class="datepicker-days" style="height: 30px;"><input type="text"><\/div><\/div>');u.operation=r.filter.operation||12;t.find(".header_container").append(f);t.data("view",f);f.show().click(function(n){n.stopPropagation()});(r.filter.type==1?Global.AutoComplete:Global.MultiSelect).Bind(Global.Copy(Global.Copy({},r.filter,!0),{elm:f.find("input"),change:function(){n.call(this.elm,i,u,u.onchange,this.elm)},buttons:[{className:u.operation==12?"minus margin-l-5":"plus margin-l-5",title:u.operation==12?"Set Exclude":"Set Include",click:function(t,r){u.operation==12?(u.operation=13,r.removeClass("glyphicon-minus").addClass("glyphicon-plus").prop("title","Set Include")):(u.operation=12,r.removeClass("glyphicon-plus").addClass("glyphicon-minus").prop("title","Set Exclude"));n.call(f.find("input"),i,u,u.onchange,f.find("input"))}}],onComplete:function(n){r.Drp=n;n.Inputs.focus();r.filter.oncomplete&&r.filter.oncomplete(n,r)}},!0));r.filter.type==2&&e(t,i,r,f);$(document).click(function(){f.find("input").val()||f.hide()})}function s(t,i,r){var f=$('<div class="search_container text_search datepicker-dropdown dropdown-menu datepicker-orient-right datepicker-orient-bottom"><div class="datepicker-days"><input type="text"><span class="btn_submit no_padding"><span class="search_icon" style="height: 20px; margin-top: 6px;"><\/span><\/span><\/div><\/div>');t.find(".header_container").append(f);t.data("view",f);f.show().click(function(n){n.stopPropagation()}).find("input").keydown(function(n){return r&&r.filter&&typeof r.filter.onkeydown=="function"&&r.filter.onkeydown.call(this,n,t,i,r),n.key=="Enter"||n.keyCode==13||n.which==13?(n.preventDefault(),n.stopPropagation(),!1):void 0}).keyup(function(n){var u=!0;r&&r.filter&&typeof r.filter.keyup=="function"&&(u=r.filter.keyup.call(this,n,t,i,r));n.stopPropagation();u!==!1&&l.call($(this),n,i,r)}).blur(function(){a.call($(this),i,r)}).focus().next().click(function(){n.call(f.find("input"),i,r)});$(document).click(function(){f.find("input").val()||f.hide()});r.filter&&r.filter.type==2&&e(t,i,r,f);u.Operation.Bind(t,i,r,f);i.FilterModelList.push({View:f,Model:r})}function v(n,t){if(t.filter&&typeof t.filter==typeof t&&(setNonCapitalisation(t.filter),(t.filter.type!=2||t.filter.displaytype)&&(t.filter.DropDown||t.filter.url||t.filter.darasource))){o(this,n,t);return}s(this,n,t)}function y(n){n.stopPropagation();var t=$(this).closest("th"),r=t.data("model"),u=t.parent().data("model"),i=t.data("view");return i?i.show().find("input").focus():v.call(t,u,r),!1}this.Bind=function(){this.find(".icon_container").append($('<span class="search_icon"><\/span>').click(y)).addClass("filter_icon_container")}};this.GetTemplate=function(n,t){var i=n.resizable||IqraConfig.Grid.resizable&&n.resizable!==!1;n.columns=ft.Get(n);n.RSModel.IsHide&&t.append('<th rowspan="1" scope="col" class="i-header table_header"><\/th>');n.RSModel.ActiveColumns.each(function(r){var f;f=this.sorting===!1?$('<th rowspan="1" scope="col" class="i-header table_header sorting '+this.className+'"><div style="position: relative;" class="header_container">'+this.title+'<span class="icon_container"><\/span><\/div><\/th>').data("model",this):$('<th rowspan="1" scope="col" class="i-header table_header sorting '+this.className+'"><div style="position: relative;" class="header_container"><a>'+this.title+'<\/a><span class="icon_container"><\/span><\/div><\/th>').click(s).data("model",this);u.Calculation.BindTH(n,this,f,r);t.append(f);this.filter&&o.Bind.call(f);i&&u.Resize.Bind(r,f,t,this,n)});t.data("model",n);n.action&&t.append(h(n,t));n.header={view:t};n.FilterModelList=[]};this.Set=function(n,t){var r=$('<div class="i-grid-header" style="padding-right: 17px;"><\/div>');r.append('<div class="i-grid-header-wrap"><table>'+a(n,t)+"<thead><tr><\/tr><\/thead><\/table><\/div>");i.GetTemplate(n,r.find("tr"));t=t.find(".i-grid-header_container");t.html(r);c(n,t[0],r)}},f=new function(){function r(n){return typeof n.url=="function"?n.url():n.url}function f(t){if(t.Template)t.Template.toggle();else{t.Template=$('<tr  role="row"><td colspan="'+t.tr.find("td").length+'" style="padding: 5px 5px 5px 20px;"><\/td><\/tr>');data=t.data;t.tr.after(t.Template);var i=t.Template.find("td");t.model.RSModel.HideColumns.each(function(){var r=data[this.field],u,f;this.dateFormat&&/^\/Date\(\-?\d+\)\/$/.test(r)&&(r=data[this.field]=r.getDate().format(this.dateFormat));r=typeof r!="undefined"&&r!=null?r:"";u=this.className?'class="'+this.className+'"':"";f=typeof this.click=="function"?$("<div "+u+"><label> "+(this.title||this.field)+"<\/label> : <\/div>").append(n(data,this,Global.Click($("<a>"+r+"<\/a>"),this.click,data,!1,this,t))):$("<div "+u+"><label> "+(this.title||this.field)+"<\/label> : <\/div>").append(n(data,this,$("<span>"+r+"<\/span>")));i.append(f)});typeof t.model.rowBound=="function"&&t.model.rowBound.call(this,i)}t.elm.find(".glyphicon").toggleClass("glyphicon-chevron-down")}function o(n,t,i){var r=$('<td class="btn_colupse" style="padding: 0px 0px 0px 3px;"><span class="icon_container"><span class="glyphicon glyphicon-chevron-right"><\/span><\/span><\/td>'),u={model:n,data:t,elm:r,tr:i};return Global.Click(r.find(".icon_container"),f,u),r}function c(n,t,i){var r=$('<td class="'+(n.action.className||"")+'" >');return n.action.items.each(function(){var t=this.html?$(this.html):$('<input type="button" value="'+(this.text||"")+'">');Global.Click(t,this.click,i,!1,n);r.append(t)}),r}function l(n,t,i){t.isautobind!=!1&&Global.AutoBind(n,i,t.field,t.type,2)}function n(n,t,i){return t.autobind!=!1&&l(n,t,i),i}function a(t,i,r,u){var e=w(i,r),f=i.className?'class="'+i.className+'"':"";return i.style&&(f+=f?' style="'+i.style+'"':'style="'+i.style+'"'),typeof i.click=="function"?$("<td "+f+"><\/td>").append(n(t,i,Global.Click($("<a>"+e+"<\/a>"),i.click,t,!1,i,u))):n(t,i,$("<td "+f+">"+e+"<\/td>"))}function t(n,t){var i=$('<tr class="grid_item" role="row">').data("model",this),r=this;return n.RSModel.IsHide&&i.append(o(n,this,i)),n.RSModel.ActiveColumns.each(function(f){var e=this.getText(r,this.field),o;this.dateFormat&&/^\/Date\(\-?\d+\)\/$/.test(e)&&(e=r[this.field]=e.getDate().format(this.dateFormat));e=typeof e!="undefined"&&e!=null?e:"";o=a(r,this,e,n);i.append(o);u.Calculation.Bind.call(n,o,r,this,t,f);this.bound&&this.bound.call(r,o,i,this,n,e)}),n.action&&i.append(c(n,i,r)),typeof n.rowBound=="function"&&n.rowBound.call(this,i,n.Body.view),n.details&&typeof n.details=="function"&&Global.DblClick(i,n.details,this,!1,n),i}function i(n){n.Body.view.empty();n.response.Data.Data.each(function(i){n.Body.view.append(t.call(this,n,i))});(n.PageSize||n.pagger)&&s.SetPagging(n);n.oncreated&&n.oncreated()}function v(n){var t,r,f;if(window.filterModel={},t=[],r="item",n.page=n.page||{PageNumber:1,PageSize:9999999},n.page.filter=n.page.filter||[],n.page.filter.length>0?(n.page.filter.each(function(){filterModel[this.field]=new RegExp(this.value,"i");r+=" && item."+this.field+".Contains(filterModel."+this.field+")"}),f=new Function("item","return "+r),n.dataSource.each(function(){f(this)&&t.push(this)})):t=n.dataSource,n.page.SortBy&&(t=t.orderBy(n.page.SortBy,n.page.IsDescending)),n.dataBinding(t),n.response={Data:{Data:t.skip((n.page.PageNumber-1)*n.page.PageSize).take(n.page.PageSize),Total:t.length,PageSize:n.page.PageSize,PageNumber:n.page.PageNumber}},i(n),n.onsummary){n.onsummary(n,n.response.Data);n.response.Data.Total&&u.Summary.Populate(n.response.Data,n)}}function y(n){if(!n||!n.Data)return n;if(n.Data.Orginal=n.Data.Data||[],n.Data.Columns&&typeof n.Data.Columns.each=="function"){n.Data.Data=[];var i,t={};n.Data.Orginal.each(function(){i=this;n.Data.Data.push(t);n.Data.Columns.each(function(n){t[this]=i[n]});t={}})}return n}var b=this;this.Add=function(n,i){i.Body.view.prepend(t.call(n,i));e(i)};this.AddTottom=function(n,i){i.Body.view.append(t.call(n,i));e(i)};this.SaveChange=function(n){n.tr&&n.tr.find&&n.tr.find("td,a").each(function(){this.dataset.field&&(this.innerHTML=n[this.dataset.field])})};this.Reload=function(n,t){if(n.dataSource&&typeof n.dataSource==typeof[])v(n,t),n.changed&&n.changed({Type:0,Category:1}),e(n);else if(n.isActive!=!1){p(n);n.page.filter=n.page.filter||[];var f={SortBy:n.page.SortBy,filter:n.page.filter.slice(),IsDescending:n.page.IsDescending,PageNumber:n.page.PageNumber,PageSize:n.page.PageSize,Id:n.page.Id};n.onrequest&&n.onrequest(f);Global.CallServer(r(n),function(r){r.IsError?(console.log(["model",n]),typeof n.onerror=="function"&&n.onerror(r)||Global.ShowError(r.Id,{path:n.url,section:"Grid"})):(n.ondata&&n.ondata(r,n),r=y(r),n.dataBinding(r),n.SummaryData={},typeof r.Data.Total==typeof r&&(n.SummaryData=Global.Copy({},r.Data.Total,!0)),n.response=r,u.Summary.Populate(r.Data,n),i(n),n.dataBound(r),typeof t=="function"&&t(),n.changed&&n.changed({Type:0},r),e(n));h(n)},function(t){typeof n.onerror=="function"&&n.onerror(t)||alert("Network error had occured.");h(n)},f,"POST")}};this.Create=i},y=new function(){this.GetTemplate=function(n,t){if(n.pagging){var i=$('<div class="i-pager-wrap i-grid-pager i-widget"><div class="pagger"><\/div><span class="i-pager-sizes i-label"><\/span><span class="i-pager-info i-label"><\/span><\/div>');t.append(i);n.footer={showingInfo:i.find(".i-pager-info"),pagging:i.find(".pagger"),pageSize:i.find(".i-pager-sizes")};n.footer.pagging.data("model",n)}};this.Set=function(n,t){n.pagging===!1;console.log(["model.footer",n.pagger,n,!n.PageSize&&n.footer,!n.PageSize,n.footer]);y.GetTemplate(n,t);!n.PageSize&&n.footer&&(n.pagger=Global.Copy({showingInfo:"Showing {0} to {1}  of {2}  items",items:IqraConfig.Grid.Pagger.PageSize,selected:IqraConfig.Grid.Pagger.Selected},n.pagger||{}),k.Create(n,n.pagger.items,n.pagger.selected,n.footer.pageSize,n.pagger.showingInfo))}},et=new function(){var n=this;this.Create=function(n){var r=$('<div class="i-grid-container"><div class="grid_column_selector_container"><\/div><div class="i-grid i-widget"><div class="i-grid-header_container"><\/div><\/div><\/div>'),t=r.find(".i-grid"),i;n.elm.append(r);console.log(["Grid=>model.elm",n.elm]);u.Selector.Set(n,r);v.Set(n,t);i=$('<div class="i-grid-content"><table>'+a(n,t)+"<tbody><\/tbody><\/table><\/div>");t.append(i);i=i.find("table");n.views={wrapper:t,table:i,tBody:i.find("tbody"),tHead:t.find("thead"),container:t};(n.resizable||IqraConfig.Grid.resizable&&n.resizable!==!1)&&u.Resize.SetCols(n);n.Body={view:n.views.tBody};y.Set(n,t);ut.Bind(n);u.Periodic.Bind(n);u.Summary.Bind(n)}},s=new function(){function t(n,t,i,r,u){n.footer.pagging.append($('<a class="i-link i-pager-nav'+i+'" title="'+u+'" href="#"><span class="i-icon i-i-'+r+'">'+u+"<\/span><\/a>").click(function(){return s.Go(n,t),!1}))}function e(n,t,i){i.append($('<li><a class="i-link" href="#">'+t+"<\/a><\/li>").click(function(){return s.Go(n,t),!1}))}function i(n,t,i){n.append($('<li><span class="'+t+'">'+i+"<\/span><\/li>"))}function o(n,r,u,f){var h=n.footer.pagging,s=$('<ul class="i-pager-numbers i-reset">'),o;for(h.empty(),r>1?(t(n,1," i-pager-first","seek-w","Go to the first page"),t(n,n.page.PageNumber-1,"","arrow-w","Go to the previous page"),i(s,"","...")):n.page.PageNumber>1&&t(n,n.page.PageNumber-1,"","arrow-w","Go to the previous page"),h.append(s),o=r;o<=u;o++)o==n.page.PageNumber?i(s,"i-state-selected",o):e(n,o,s);u<f?(i(s,"","..."),t(n,n.page.PageNumber+1,"","arrow-e","Go to the next page"),t(n,f," i-pager-last","seek-e","Go to the last page")):n.page.PageNumber<f&&t(n,n.page.PageNumber+1,"","arrow-e","Go to the next page")}function h(n){var t=(n.response.Data.PageNumber-1)*n.response.Data.PageSize,i=0,u;i=n.response.Data.Total&&typeof n.response.Data.Total.Total!=typeof r?n.response.Data.Total.Total:n.response.Data.Total;end=t+n.response.Data.Data.length;t=t+(end>0?1:0);u=(n.page.showingInfo&&typeof n.page.showingInfo=="function"?n.page.showingInfo(t,end,i):n.page.showingInfo)||"Showing {0} to {1}  of {2}  items";n.footer.showingInfo.html(u.format(t,end,i))}var n=4,u={Type:3};this.Go=function(n,t){return n.changing&&n.changing(u,n.page.PageNumber,t),n.page.PageNumber=t,f.Reload(n),!1};this.SetPagging=function(t){var f,i,e,u;t.pagging&&(f=0,f=t.response.Data.Total&&typeof t.response.Data.Total.Total!=typeof r?t.response.Data.Total.Total:t.response.Data.Total,t.page.total=f,i=Math.ceil(t.page.total/t.page.PageSize),n<i&&t.page.PageNumber>n/2?(u=Math.ceil(t.page.PageNumber+n/2),u>i&&(u=i),e=u-n):(e=1,u=i>n?n:i),o(t,e,u,i),h(t))}};(function(){function n(n,t,i,u){var f={View:$('<div class="flt_operation_container"><input data-binding="Operation" class="form-control" type="text"><\/div>'),IsOpend:!0},e;typeof i.operation!=typeof r?e=i.operation:typeof IqraConfig.Grid.Operation!=typeof r&&(e=IqraConfig.Grid.Operation);u.append(f.View);f.View.find("input").val(e);f.Model={dataSource:[{text:"Equals",value:"0"},{text:"Greater Than",value:"1"},{text:"Greater Than/Equal",value:"2"},{text:"Less Than",value:"3"},{text:"Less Than/Equal",value:"4"},{text:"Contains",value:"5"},{text:"Starts With",value:"6"},{text:"Ends With",value:"7"},],elm:f.View.find("input"),selectedValue:e,selected:e,change:function(n){f.View.slideUp();f.IsOpend=!1;n?i.Operation=i.operation=n.value:typeof i.operation!=typeof r?i.Operation=i.operation:typeof IqraConfig.Grid.Operation!=typeof r&&(i.Operation=IqraConfig.Grid.Operation)}};Global.DropDown.Bind(f.Model);i.OperationModel=f}function t(n,t,i){i.OperationModel.IsOpend?(i.OperationModel.IsOpend=!1,i.OperationModel.View.slideUp()):(i.OperationModel.IsOpend=!0,i.OperationModel.View.slideDown())}this.Bind=function(i,r,u,f){var e=$('<div class="display_type" style="position: absolute; display: block; height: 15px; width: 15px; cursor: pointer; left: 5px; top: -15px;"><span class="glyphicon glyphicon-chevron-up" style="top: 0px;"><\/span><\/div>');f.append(e);Global.Click(e,function(){u.OperationModel?t(i,r,u,f):n(i,r,u,f)})}}).call(u.Operation={}),function(){function t(n){n.ColGroupTemplate=r;n.views.table.html(a(n,n.views.wrapper)+"<tbody><\/tbody>");n.views.tBody=n.views.table.find("tbody");n.Body={view:n.views.tBody};v.Set(n,n.views.wrapper);n.views.tHead=n.views.wrapper.find(".i-grid-header-wrap thead");(n.resizable||IqraConfig.Grid.resizable&&n.resizable!==!1)&&u.Resize.SetCols(n);n.dataSource&&typeof n.dataSource==typeof[]?n.Reload():(n.response&&n.response.Data&&n.response.Data.Data&&n.response.Data.Data.length&&f.Create(n),e(n))}function i(n,t,i){n.change(function(){t(i,$(this))})}function o(t,r,u){var f=t.selector,e=[],o=n[t.Id||"12345"]={},h=u.find(".i-grid").width();return r.each(function(n){setNonCapitalisation(this);this.selected=typeof this.selected=="number"?this.selected<=h:this.selected!==!1;var r=$('<label class="lbl_selector"><input type="checkbox" data-binding="selected" /> '+(this.title||this.field)+" <\/label>");Global.Form.Bind(this,r);i(r,s,{model:t,item:this});f.container.append(r);this.selected!==!1&&e.push(this);this.Id=this.Id||n;o[this.field]=this.selected}),f.columns=r,e}function s(i){var f=[],r=!1,e=n[i.model.Id||"12345"];i.model.selector.columns.each(function(){this.selected!==!1&&f.push(this);r=r||e[this.field]!==this.selected});i.model.columns=f;t(i.model);u.Setting.Changed(i.model,r)}function h(n,t,i){var r,f;setNonCapitalisation(t);r=i.find(".grid_column_selector_container");r.append('<div class="btn_selector_open"><\/div><div class="selector_content_container"><\/div>');t.container||(f=$('<span class="glyphicon glyphicon-chevron-up"><\/span>'),t.container=r.find(".selector_content_container"),r.find(".btn_selector_open").append(f),f.click(function(){t.container.slideToggle();$(this).toggleClass("glyphicon-chevron-down")}));u.Setting.SetView(n,i)}var n={},c=$("#selector_container");this.SetOrginalColumns=function(t){var i=n[t.Id||"12345"]={};t.selector.columns.each(function(){i[this.field]=this.selected})};this.Set=function(n,t){(n.selector||IqraConfig.Grid.selector&&n.selector!==!1)&&(n.selector=n.selector||Global.Copy({},IqraConfig.Grid.selector,!0),h(n,n.selector,t),n.columns=o(n,n.columns,t))}}.call(u.Selector={}),function(){function f(n,t){var u=[],r={},i;return(t||[]).each(function(){r[this.field]=this}),n.each(function(){i=r[this.field]?r[this.field]:{field:this.field};i.selected=this.selected;u.push(i)}),u}function e(n){typeof n.filter!=typeof r&&(typeof n.filter!=typeof n&&(n.filter=n.filter?this.filter?this.filter:!0:!1),this.filter=n.filter)}function o(n,t){if(t&&t.each){var u={},i;t.each(function(){u[this.field]=this});n.each(function(n){this.order=n;u[this.field]&&(i=u[this.field],this.order=i.order,typeof i.selected!=typeof r&&(this.selected=i.selected?this.selected||i.selected:!1),e.call(this,i),typeof i.sorting!=typeof r&&(this.sorting=i.sorting?this.sorting||i.sorting:!1),typeof i.width!=typeof r&&(this.width=i.width?i.width:r),typeof i.title!=typeof r&&(this.title=i.title))})}}function i(n,i){i.Version>=parseFloat((n.version||IqraConfig.Version||0)+"")&&(t[n.Id||"12345"]=i,typeof i.responsive!=typeof r&&(n.responsive=i.responsive?n.responsive||{}:!1),typeof i.selector!=typeof r&&(n.selector=i.selector?n.selector||{}:!1),typeof i.printable!=typeof r&&(n.printable=i.printable?n.printable===!1?r:n.printable:!1),typeof i.resizable!=typeof r&&(n.resizable=i.resizable?n.resizable===!1?i.resizable:n.resizable:!1),o(n.columns,i.columns),n.columns.orderBy("order"))}function s(i){var o={Id:i.id,RelationType:i.setting.relationtype||"Aplication"},e=t[i.id||"12345"]||{};e.columns=f(i.selector.columns,e.columns);e.Version=parseFloat((i.version||IqraConfig.Version||0)+"");o.Content=JSON.stringify(e);Global.CallServer("/IqraGridArea/IqraGrid/Add",function(f){f.IsError||(u.Selector.SetOrginalColumns(i),n[i.Id||"12345"]&&n[i.Id||"12345"].remove(),n[i.Id||"12345"]=r,t[i.id||"12345"]=e)},function(){},o,"POST")}var n={},t={};this.SetView=function(n,i){if(n.id&&n.setting){var r=$('<span class="glyphicon glyphicon-edit" style="top: -2px; margin-left: 15px; font-size: 0.9em;"><\/span>');i.find(".grid_column_selector_container .btn_selector_open").append(r);Global.Click(r,function(n){Global.Add({model:n,savedData:t[n.id||"12345"],name:"GridEditor",url:IqraConfig.Url.Js.GridEditor,Success:function(){}})},n)}};this.Changed=function(t,i){t.setting&&(i&&!n[t.Id||"12345"]?(n[t.Id||"12345"]=$('<label class="lbl_selector"><a class="">'+(t.setting.title||t.setting.name||" Save Changes")+"<\/a><\/label>"),t.selector.container.append(n[t.Id||"12345"]),Global.Click(n[t.Id||"12345"],s,t)):!i&&n[t.Id||"12345"]&&(n[t.Id||"12345"].remove(),n[t.Id||"12345"]=r))};this.Bind=function(n,t){var r,u,f;if(!n.id||n.setting===!1)return t(n);if(r=localStorage.getItem(n.id),r){u=JSON.parse(r);i(n,u);t(n);n.setting.onload&&n.setting.onload(u,!0);return}f=n.setting.url(n)||"/IqraGridArea/IqraGrid/GetById?Id="+n.id;Global.CallServer(f,function(r){r.IsError?(t(n),typeof n.setting.onerror=="function"&&n.setting.onerror(r)):(r.Data&&r.Data.Content&&i(n,JSON.parse(r.Data.Content)),t(n),n.setting.onload&&n.setting.onload(r))},function(i){t(n);typeof n.setting.onerror=="function"&&n.setting.onerror(i)},{},"POST")}}.call(u.Setting={}),function(){function i(i,r,u,f,e,o){n={th:u,data:e,model:o,index:r,colH:o.views.hCols[r],colT:o.views.tCols[r]};t=i.pageX-u.width()-10}function u(t){n.colH.style.width=t+"px";n.colT.style.width=t+"px";n.data.width=t}var n,t=0;$(document).mousemove(function(i){n&&(i.stopPropagation(),i.preventDefault(),u(i.pageX-t))});$(document).mouseup(function(){n&&(n=r)});this.SetCols=function(n){n.views.tCols=n.views.table.find("col");n.views.hCols=n.views.tHead.parent().find("col")};this.Bind=function(n,t,r,u,f){var e=$('<div class="resizer"><\/div>');t.find(".header_container").append(e);f.RSModel.IsHide&&n++;e.mousedown(function(e){e.stopPropagation();e.preventDefault();i(e,n,t,r,u,f)})}}.call(u.Resize={}),function(){function o(i,r){return typeof t.view==typeof n?t.view(i,r):typeof t.view=="string"?t.view:'<div id="content_container"><ul class="nav nav-tabs"><\/ul><div class="tab-content"> <\/div><\/div>'}function e(n){return n.replace(/[A-Z]/g,function(n){return" "+n})}function s(n,r,u){typeof r=="function"&&(r=r(t.model,i));i.Wait("Please wait while loading data....");Global.CallServer(r,function(t){i.Free();t.IsError||(n.onloaded=n.onloaded||n.onload,n.onloaded&&n.onloaded(n,t.Data,n.formmodel),u(t.Data))},function(n){n.Id=-8;i.Free()},null,"Get")}var u={},f={},i,t;this.Show=function(n,i,r){if(t=n,setNonCapitalisation(n),r.DataId=r.Id||Global.Guid(),u[r.Id])u[r.Id].IsOpended?(u[r.Id].IsOpended=!1,u[r.Id].view.fadeOut()):(u[r.Id].IsOpended=!0,u[r.Id].view.fadeIn());else{var e=u[r.Id]={IsOpended:!0};e.view=$('<tr class="grid_details"><td colspan="'+r.find("td").length+'" style="padding: 5px 5px 5px 20px;"><\/td><\/tr>');r.after(e.view);e.view.find("td").append(t.view||o(i,r));f.Tab.Bind(e,i,r)}},function(){function c(n){n.tabs.each(function(){this.button.elm.removeClass("in active");this.View.removeClass("in active")})}function o(n,t){n.AllColumns.each(function(){typeof t[this.field]!=typeof r&&(this.type==1?n.formmodel[this.field]=(t[this.field]||0).toFloat():this.type==2?n.formmodel[this.field]=(t[this.field]||0).toMoney():this.type==3||this.dateformat?t[this.field]?n.formmodel[this.field]=(t[this.field]+"").getDate().format(this.dateformat||"yyyy/MM/dd hh:mm"):"":typeof t[this.field]=="undefined"?"":n.formmodel[this.field]=t[this.field])});n.onpopulated&&n.onpopulated(n,t)}function h(n,t){c(t);n.button.elm.addClass("active");n.View.addClass("in active");n.grid&&n.grid.each(function(){this.IsCreated?this.Model.Reload():this.GridModelCreators()});n.model&&n.columns&&n.columns.length&&o(n,n.model);n.detailsurl&&s(n,n.detailsurl,function(t){o(n,t)})}function l(n,r,f){typeof r.button=="function"?r.button={elm:r.button(r,u,i,t)}:typeof r.button=="string"?r.button={elm:$(r.button)}:typeof r.button=="object"&&(setNonCapitalisation(r.button),r.button={elm:$("<li"+(r.button.class?' class="'+r.button.class+'"':"")+"><a>"+(r.button.title||e(r.button.name||"Tab_"+f))+"<\/a><\/li>")});typeof r.button.elm=="string"&&(r.button.elm=$(r.button.elm))}function a(n,t,i){t.button?l(n,t,i):t.button={elm:$("<li><a>"+(t.title||e(t.name||"Tab_"+i))+"<\/a><\/li>")};n.TabContainer.Button.append(t.button.elm);Global.Click(t.button.elm,h,t,!0,n)}function v(n){n.TabContainer=u={Button:n.view.find(".nav-tabs"),Content:n.view.find(".tab-content")};n.tabs=[];t.Tabs.each(function(t){this.PositionIndex=t;setNonCapitalisation(this);a(n,this,t);f.Content.Create(this,n);this.Bind=function(){h(this,n)};n.tabs.push(this);this.TabModel=this});n.tabs[t.selected]&&n.tabs[t.selected].Bind()}var n,u,f={};this.Bind=function(i,r,u){t.selected=t.selected||0;n?(t.Tabs.each(function(t){setNonCapitalisation(this);n[t].detailsurl=this.detailsurl;n[t].model=this.model}),n[t.selected]&&n[t.selected].Bind()):v(i,r,u)},function(){function o(n,t,i){var r=n.class||n.classname||"",u=' class="'+(r?r+" ":"")+'col-sm-6 col col-md-6" style="width:'+i+'%" ';r=r?r+" ":"";switch(t){case 1:u=' class="'+r+'col-sm-12 col col-md-12" ';break;case 2:u=' class="'+r+'col-sm-6 col col-md-6" ';break;case 3:u=' class="'+r+'col-sm-4 col col-md-4" ';break;case 4:u=' class="'+r+'col-sm-3 col col-md-3" ';break;case 6:u=' class="'+r+'col-sm-2 col col-md-2" '}return u}function s(n,t){var u="",i=Global.Copy(Global.Copy({},n.add||{},!0),n.details||{}),r;if(i.sibling=i.sibling||2,r=parseInt(100/i.sibling),t.width-=r,t.width<0&&(t.width=100-r,u='<\/div><div class="row">'),i.template)return u+i.template;var f=n.required==!1?"":"required ",e=n.dateFormat?'data-dateformat="'+n.dateFormat+'" ':"",s=f+'data-binding="'+n.field+'" name="'+n.field,h="<span "+e+s+'" class="form-control auto_bind"><\/span>';return u+"<section "+o(n,i.sibling,r)+'><div><label for="'+n.field+'">'+n.title+'<\/label><\/div><div class="input-group">'+h+" <\/div><\/section>"}function f(t,i){t.each(function(){setNonCapitalisation(model);this.field=this.title=this.Id.replace(/id\s*$/i,"");this.isDropDown=!0;this.position=typeof this.position=="undefined"?n:this.position;i.push(this);this.change&&f([this.change],i)})}function e(t,i){setNonCapitalisation(t);t.detail!=!1&&(t.title=t.title||t.field,t.position=typeof t.position=="undefined"?n:t.position,i.push(Global.Copy({},t)))}function h(n,t){setNonCapitalisation(n);e(n,t)}function c(n){var i='<div class="columns_container"><div class="row">',r={width:100},t;n.columns=n.columns||[];n.dropdownlist=n.dropdownlist||[];n.additionalfield=n.additionalfield||[];t=n.AllColumns=[];n.columns.each(function(){e(this,t)});n.additionalfield.each(function(){h(this,t)});f(n.dropdownlist,t);t.orderBy("position");t.each(function(){this.detail!=!1&&this.details!=!1&&(i+=s(this,r))});n.ColumnView=$(i+"<\/div><\/div>");n.formmodel=n.formmodel||{};Global.Form.Bind(n.formmodel,n.ColumnView);n.View.append(n.ColumnView)}var n=1e3,u={};this.Create=function(n,t){n.View=$(n.View||'<div class="tab-pane fade"><\/div>');t.TabContainer.Content.append(n.View);c(n,t);u.Grid.Create(n,t)},function(){function f(i,r,u,f,e){f.View=$(f.template||'<div class="grid_section"><div class="filter_container row" style="margin:10px 0;"><\/div><div class="summary_container row" style="margin:10px 0;"><\/div><div class="empty_style button_container row"><\/div><div class="margin-top-10 grid_container"><\/div><\/div>');u.append(f.View);(f.buttons||[]).each(function(i){setNonCapitalisation(this);n=$(this.html||'<a style="margin-right: 5px;margin-left: 5px;" class="btn btn-default btn-round pull-right"><span class="glyphicon '+(this.class||"glyphicon-open")+'"><\/span> '+(this.text||this.title||this.name||"Button_"+i)+" <\/a>");f.View.find(this.selector||".button_container").append(n);Global.Click(n,this.click||void 0,{Button:this,Grid:f,Tab:r,options:t})});f.onviewcreated&&f.onviewcreated(f.View,f,e)}function e(n){this.IsDeleted&&(n.css({color:"red"}).find(".glyphicon-trash").css({opacity:.3,cursor:"default"}),n.find("a").css({color:"red"}));this.UpdatedAt&&n.find(".updator").append("<\/br><small><small>"+this.UpdatedAt.getDate().format("dd/MM/yyyy hh:mm")+"<\/small><\/small>");this.CreatedAt&&n.find(".creator").append("<\/br><small><small>"+this.CreatedAt.getDate().format("dd/MM/yyyy hh:mm")+"<\/small><\/small>")}function o(n,t){t.summary&&t.summary.items&&t.summary.items.length&&(t.summary.items.each(function(){if(this.onsetvalue)this.onsetvalue(n.Total,t.summary.container);else t.formmodel[this.field]=this.type==1?(n.Total[this.field]||0).toFloat():this.type==2?(n.Total[this.field]||0).toMoney():this.type==3?(n.Total[this.field]||"").getDate().format(this.format||"dd/MM/yyyy"):n.Total[this.field]||""}),n.Total=typeof n.Total.Total=="undefined"?n.Total:n.Total.Total)}function s(n,t,i){n.FilterModels={};(i||[]).each(function(){n.FilterModels[this.field]=!0})}function u(n,t,i){var f,u;return f=typeof t.filter=="function"?t.filter(t,u):t.filter,page=t.page||{PageNumber:1,PageSize:10,showingInfo:" {0}-{1} of {2} Items ",filter:f},u=Global.Copy(Global.Copy({},t,!0),{elm:t.View.find(t.selector||".grid_container"),columns:typeof t.columns=="function"?t.columns(t,i):t.columns,url:t.url,page:page,dataBinding:function(n){t.ondatabinding&&t.ondatabinding(n);o(n.Data,t)},rowBound:t.rowbound||e,onComplete:function(n){t.Model=n;t.oncomplete&&t.oncomplete(n)},Printable:t.printable||{Container:function(){return t.View.find(".button_container")}}},!0),u.Printable.Container=u.Printable.container=u.Printable.Container||u.Printable.container||function(){return t.View.find(".button_container")},u.Printable.summary=u.Printable.summary||(t.summary?t.summary.items:r),console.log(["opts.Printable.summary",u.Printable.summary,u.Printable]),s(t,u,f),u}function h(n,t,i,r){i.GridModelCreators=function(){i.IsCreated=!0;c(n,t,i,r);a(n,t,i,r);i.actions||i.isList?(i=u(t,i,r),i.onDataBinding=i.dataBinding,Global.List.Bind({Name:i.name,Grid:i,onComplete:i.complete,Add:i.add?i.add:!1,remove:i.remove?i.remove:!1,Edit:i.edit?i.edit:!1})):Global.Grid.Bind(u(t,i,r))}}function c(n,t,i,r){var u=i.periodic,f;u&&(setNonCapitalisation(u),u.container=u.container||u.selector,f=typeof u.container=="function"?u.container(i.View,r,i,t):typeof u.container=="string"?i.View.find(u.container):u.container||i.View.find(".filter_container"),u.model={container:f,filter:i.filter,formmodel:i.formmodel,Type:u.selected||"ThisMonth",field:u.field||"CreatedAt",format:u.format||"yyyy/MM/dd",onchange:function(n){(!u.onchange||u.onchange(n,i.Model,i))&&i.Model&&(i.Model.page.filter=n,i.Model.Reload&&i.Model.Reload())}},i.filter=u.filter=Global.Filters().Bind(u.model),l(u,t,i,r))}function l(n,t,i){var r=n.filterby,u={};r&&(setNonCapitalisation(r),r.datasource=r.datasource||[],r.datasource.each(function(){u[this.value]=!0}),r.model={elm:n.model.container.append('<div class="col-md-2 col-sm-4 col-xs-6"><div><label>'+(r.title||"Filter By")+'<\/label><\/div><div><input data-binding="FilterBy" class="form-control filterby" data-type="string" type="text"/><\/div><\/div>').find(".filterby"),dataSource:r.datasource,selectedValue:n.field||"CreatedAt",change:function(t){t&&(n.model.field=t.value,n.filter&&n.filter.each(function(){u[this.field]&&(this.field=t.value)}),i.Model&&i.Model.Reload&&i.Model.Reload())}},Global.DropDown.Bind(r.model))}function a(n,t,i,r){if(i.summary){var u,f;i.formmodel=i.formmodel||{};i.summary.New&&i.summary.each&&i.summary.orderBy&&(i.summary={items:i.summary});setNonCapitalisation(i.summary);f=typeof i.summary.container=="function"?i.summary.container(i.View,r,i,t):typeof i.summary.container=="string"?i.View.find(i.summary.container):i.summary.container||i.View.find(".summary_container");i.summary.items.each(function(n){typeof i.summary.items[n]=="string"?i.summary.items[n]=u={field:""+this,title:""+this}:typeof i.summary.items[n]=="object"&&(setNonCapitalisation(this),u=this);f.append(u.template||u.html||'<div class="col-md-2 col-sm-4 col-xs-6"><div><label> '+(u.title||u.field)+' <\/label><\/div><div><span data-binding= "'+u.field+'" class ="form-control auto_bind'+(u.class?" "+u.class:"")+'"><\/span><\/div><\/div>')});Global.Form.Bind(i.formmodel,f)}}var n;this.Create=function(n,t){n.GridModelCreators=[];n.grid&&n.grid.each(function(r){typeof this=="function"?(this.Model={Reload:noop},this.IsCreated=!0,this(i,n.View,r,this.Model,function(t){n.grid[r].Model=t})):(setNonCapitalisation(this),f(t,n,n.View,this,r),h(t,n,this,r))})}}.call(u.Grid={})}.call(f.Content={})}.call(f.Tab={})}.call(u.Details={}),function(){function n(n,t){t.summary&&t.summary.items&&t.summary.items.length&&(t.summary.items.each(function(){if(this.onsetvalue)this.onsetvalue(n.Total,t.summary.container);else t.formmodel[this.field]=this.type==1&&(n.Total[this.field]||0).toFloat?(n.Total[this.field]||0).toFloat():this.type==2&&(n.Total[this.field]||0).toMoney?(n.Total[this.field]||0).toMoney():this.type==3?(n.Total[this.field]||"").getDate().format(this.format||"dd/MM/yyyy"):n.Total[this.field]||""}),n.Total=typeof n.Total.Total=="undefined"?n.Total:n.Total.Total)}function t(n){if(n.summary){var t,i;n.formmodel=n.formmodel||{};n.summary.New&&n.summary.each&&n.summary.orderBy&&(n.summary={items:n.summary});setNonCapitalisation(n.summary);i=typeof n.summary.container=="function"?n.summary.container(n):typeof n.summary.container=="string"?$(n.summary.container):n.summary.container||$(".summary_container");n.summary.items.each(function(r){typeof n.summary.items[r]=="string"?n.summary.items[r]=t={field:""+this,title:""+this}:typeof n.summary.items[r]=="object"&&(setNonCapitalisation(this),t=this);i.append(t.template||t.html||'<div class="col-md-2 col-sm-4 col-xs-6"><div><label> '+(t.title||t.field)+' <\/label><\/div><div><span data-binding= "'+t.field+'" class ="form-control auto_bind'+(t.class?" "+t.class:"")+'"><\/span><\/div><\/div>')});n.formInputs=Global.Form.Bind(n.formmodel,i)}}this.Bind=function(n){t(n)};this.Populate=function(t,i){n(t,i)}}.call(u.Summary={}),function(){function n(n){var i=n.periodic,r;i&&(setNonCapitalisation(i),i.container=i.container||i.selector,r=typeof i.container=="function"?i.container(n):typeof i.container=="string"?$(i.container):i.container||$(".filter_container"),n.page.filter=n.page.filter||[],i.model={container:r,filter:n.page.filter,formmodel:n.formmodel,oncomplete:i.oncomplete,Type:i.selected||i.type||"ThisMonth",field:i.field||"CreatedAt",format:i.format||"yyyy/MM/dd HH:mm",onchange:function(t){(!i.onchange||i.onchange(t,n.Model,n))&&(n.Reload&&n.Reload(),console.log(["grid.page",n.page.filter,t]))}},n.filter=i.filter=Global.Filters().Bind(i.model),t(i,n),console.log(["grid.page",n.page.filter,n.page]))}function t(n,t){var i=n.filterby,r={};i&&(setNonCapitalisation(i),i.datasource=i.datasource||[],i.datasource.each(function(){r[this.value]=!0}),i.model={elm:n.model.container.append('<div class="col-md-2 col-sm-4 col-xs-6"><div><label>'+(i.title||"Filter By")+'<\/label><\/div><div><input data-binding="FilterBy" class="form-control filterby" data-type="string" type="text"/><\/div><\/div>').find(".filterby"),dataSource:i.datasource,selectedValue:n.field||"CreatedAt",change:function(i){i?(n.model.field=i.value,n.filter&&n.filter.each(function(){r[this.field]&&(this.field=i.value)}),t.Reload&&t.Reload()):t.Reload&&t.Reload()}},Global.DropDown.Bind(i.model))}function i(n){b.SetDefaultOptions(n);n.Printable}this.Bind=function(t){n(t);t.periodic&&i(t)}}.call(u.Periodic={}),function(){function e(){return u?u:(u=$('<div style="position: fixed; border: 1px solid silver; top: 20px; z-index: 9999999; padding: 10px; border-radius: 5px; color: white; min-width: 100px; text-align: center; right: 20px; display: none;"><div style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; z-index: -1; background-color: rgb(92, 180, 91); opacity: 0.85;"><\/div><div class="auto_bind" data-binding="value"><\/div><\/div>'),Global.Form.Bind(f,u),$(document.body).append(u),u)}function o(t,u,f){n[f]===1?i-=u:i+=u;n[f]=r}function s(t,r,u,s){var h=u+"_"+s;Global.Key.ctrlKey&&Global.Key.altKey?(n[h]?o(t,r,h):(i-=r,n[h]=2),e().show()):Global.Key.ctrlKey&&(n[h]?o(t,r,h):(i+=r,n[h]=1),e().show());f.value=i.toMoney();console.log(["dataModel",n])}function h(r,u,o){console.log(["calculateShift",r,u,o]);var s=r.RSModel.ActiveColumns[o],c=Math.max(t.row,u),l=Math.min(t.row,u),h=r.response.Data.Data[0],v=i,a="";h&&(h[s.field]||h[s.field]==0)&&h[s.field].toMoney&&(r.response.Data.Data.each(function(t){(t>l&&t<c||t==l&&l==u||t==c&&c==u)&&(a=t+"_"+o,n[a]||(v+=this[s.field],n[a]=1))}),e().show(),f.value=(i=v).toMoney());t.col=o;t.row=u}var f={},n={},i=0,u,t={row:-1,col:-1};$(document).click(function(){i=0;f.value=0;n={};e().hide();t={row:-1,col:-1}});this.Bind=function(n,i,r,u,f){var e=this;n.click(function(n){var o=i[r.field];o&&o.toMoney&&(t.col==-1&&(t.col=f),t.col==f&&Global.Key.ctrlKey&&Global.Key.shiftKey?h(e,u,f):s(i,o,u,f,n),t.col=f,t.row=u);Global.Key.ctrlKey&&(n.preventDefault(),n.stopPropagation())})};this.BindTH=function(t,r,u,o){u.click(function(u){if(Global.Key.ctrlKey&&t.response&&t.response.Data&&t.response.Data.Data){var s=t.response.Data.Data[0],h=0;s&&(s[r.field]||s[r.field]==0)&&s[r.field].toMoney&&(n={},t.response.Data.Data.each(function(t){h+=this[r.field];n[t+"_"+o]=1}),e().show(),f.value=(i=h).toMoney(),u.preventDefault(),u.stopPropagation())}})}}.call(u.Calculation={}),function(t,i){function v(n){n.each(function(){for(var n in this)this[n.toLowerCase()]=this[n];this.title=this.title||this.field;typeof this.filter==typeof r&&(this.filter=!0);this.getText=this.gettext||(this.text?function(){return this.text}:w)})}function w(n,t){return n[t]}function k(t){for(var i in t)t[i.toLowerCase()]=t[i];t.columns=t.columns||[];v(t.columns);t.Printable&&setNonCapitalisation(t.Printable);t.details=t.details||t.detail||t.ondetails||t.ondetail;t.id&&t.setting!==!1&&(t.setting=t.setting||{},setNonCapitalisation(t.setting),t.id&&(t.setting=Global.Copy(Global.Copy({},IqraConfig.Grid.setting||{}),t.setting||{})),t.setting.url=t.setting.url||n)}var o=[187,216,210,212,221,226,212,178,222,211,212],l=[18,19,17,8,13,6],a=[5,17,14,12,2,7,0,17,2,14,3,4],e,c=i;this.GetFooterTemplate=function(n){return y.GetTemplate(n)};this.SetPagging=function(n){return s.SetPagging(n)};this.Bind=function(n){return k(n),c[e(c[o],[0])][e([21])]&&u.Setting.Bind(n,function(n){n.pagging=typeof n.pagging=="undefined"?!0:n.pagging;n.dataBinding=n.dataBinding||noop;n.dataBound=n.dataBound||noop;et.Create(n);f.Reload(n);b.Bind(n);n.elm.data("model",n);n.Reload=function(t){if(typeof n.page=="object",n.page&&n.page.filter&&n.page.filter.length){var i={};n.page.filter.each(function(){i[this.field]=this});n.FilterModelList.each(function(){i[this.Model.field]&&i[this.Model.field].value||(this.View.find("input").val(""),this.View.hide())})}else n.FilterModelList.each(function(){this.View.find("input").val("");this.View.hide()});f.Reload(n,t)};n.SetData=function(t,i){n.dataSource=t;f.Reload(n,i)};n.Add=function(t){n.dataSource&&n.dataSource.unshift(t);f.Add(t,n)};n.AddTottom=function(t){n.dataSource&&n.dataSource.push(t);f.AddTottom(t,n)};n.AddToBottom=function(t){n.dataSource&&n.dataSource.push(t);f.AddTottom(t,n)};n.SaveChange=function(){typeof n.page=="object"&&(n.page.PageNumber=1,n.page.SortBy="");f.Reload(n)};n.Busy=function(){p(n)};n.Free=function(){h(n)};n.ShowDetails=function(n,t,i){u.Details.Show(n,t,i)};n.oncomplete&&n.oncomplete(n)}),n},function(n,t){var i="";e=t.string;o.each(function(){i+=n[e(l,[0])][e(a,[4,8])](this-111)});o=i}(t,i)}.call(this.Service={},t,i)}).call(Global.Grid,function(){},window,Global)